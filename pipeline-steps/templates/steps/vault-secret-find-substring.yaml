parameters:
  azureSubscriptionEndpoint: $(azure.subscription.endpoint)
  azureVault: ''
  secretName: ''
  valueToFindOrReplace: ''

steps:
  - task: AzureCLI@2
    displayName: "Find value in secret from valut"
    inputs:
      azureSubscription: ${{ parameters.azureSubscriptionEndpoint }}
      scriptType: 'bash'
      scriptLocation: 'inlineScript'
      inlineScript: |
        currentValue=$(az keyvault secret show --vault-name ${{ parameters.azureVault }} --name ${{ parameters.secretName }} --query 'value' -o tsv)
        if [[ $currentValue == *"${{ parameters.valueToFindOrReplace }}"* ]]; then
            echo "Value to find found as substring in secret."
        else
            echo "Value not found in secret."
        fi

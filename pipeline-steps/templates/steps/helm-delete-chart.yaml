parameters:
  jobName: ''
  azureSubscriptionEndpoint: ''
  azureAksResourceGroup: ''
  azureAksCluster: ''
steps:
- template: ./aks-authenticate.yaml
  parameters:
    azureSubscriptionEndpoint: ${{ parameters.azureSubscriptionEndpoint }}
    azureAksResourceGroup:  ${{ parameters.azureAksResourceGroup }}
    azureAksCluster:  ${{ parameters.azureAksCluster }}
- template: ./docker-tag.yaml
- task: AzureCLI@1
  condition: succeeded()
  displayName: "Helm delete Job Chart"
  inputs:
    azureSubscription: ${{ parameters.azureSubscriptionEndpoint }}
    scriptLocation: "inlineScript"
    inlineScript: |
      helm delete ${{ parameters.jobName }}-$(imageSha)-b$(Build.BuildId)  